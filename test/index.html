<!DOCTYPE 5>
<html>
  <head>
    <title>ToggleCollection</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <style>
      body {
        padding: 60px;
        font: 300 14px "Helvetica Neue", Helvetica, Arial;
        min-height: 1000px;
      }
      
      #data ul {
        list-style-type: none;
        -webkit-margin-before: 0;
        -webkit-margin-after: 0;
        -webkit-padding-start: 0;
      }
      
      #data > ul {
        margin: 10px 5px;        
      }
      
      #data > ul > li {
        margin: 5px 0;
      }
      
      #data > ul > li > ul > li {
        display: table-cell;
        vertical-align: middle;
        padding: 0 5px;
      }
      
      #data .selectable {
        width: 1em;
        background: none;
        border: 1px solid lightgrey;
      }
      
      #data .selectable:hover {
        cursor: pointer;
      }
      
      #data .selectable.selected {
        background-color: #ff6666;
      }
      
    </style>
  </head>
  <body>
    <h1>ToggleCollection</h1>
    <div id="data"></div>
    <button id="randomize">Randomize</button>

    <script src="../build/build.js"></script>
    <script>
      var Togs = require('toggle-collection')
        , domify = require('component-domify')
        , list = ['One', 'Two', 'Three', 'Four', 'Five']
        
      var toggles = Togs('#data').toggleOn('click .selectable', [null, 'selected']);
      
      document.getElementById('randomize').onclick = function(){
        genList( randList(list), document.getElementById('data') );
        toggles.refresh();
      }
      
      function randList(input) {
        var perms = permute(input)
        return perms[ Math.floor(Math.random() * (perms.length + 1)) ];
      }
      
      function genList(input,el){
        var listEl = domify('<ul></ul>')[0];
        for (i=0;i<input.length;++i) {
          var recEl = domify('<li><ul></ul></li>')[0],
              fldsEl = recEl.querySelector('ul');
          fldsEl.appendChild(domify('<li class="selectable" data-id="' + input[i] + '"></input></li>')[0]);
          fldsEl.appendChild(domify('<li>' + input[i] + '</li>')[0]);
          listEl.appendChild(recEl);
        }
        el.innerHTML = '';  // wipe it out
        el.appendChild(listEl);
      };
      
      function permute(input) {
          var permArr = [],
          usedChars = [];
          function main(input){
              var i, ch;
              for (i = 0; i < input.length; i++) {
                  ch = input.splice(i, 1)[0];
                  usedChars.push(ch);
                  if (input.length == 0) {
                      permArr.push(usedChars.slice());
                  }
                  main(input);
                  input.splice(i, 0, ch);
                  usedChars.pop();
              }
              return permArr;
          }
          return main(input);
      };
      
      genList(list, document.getElementById('data'));
      
    </script>
  </body>
</html>
